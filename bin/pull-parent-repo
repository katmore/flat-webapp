#!/usr/bin/env bash
################################################################################
## pull-public-master
##    git wrapper to pull/merge "parent" repo's updates to a "child" repo.
##       Performs a pull/merge from a remote repo to the local repo.
##    Inspired by stackoverflow thread: 
##       http://stackoverflow.com/questions/10065526/github-how-to-make-a-fork-of-public-repository-private
##    NOTE:
##       This script "doesn't work" if executed from within the parent repo. 
##       It should be executed within the "child" repo.
################################################################################
## Copyright (c) 2012-2016 Doug Bird. All Rights Reserved.
##    This file part of the 'boilerplate flat web application'; see
##    https://github.com/katmore/flat-webapp
## License:
##    "The flat framework" and "boilerplate flat web application"
##    is copyrighted free software.
##    You can redistribute it and/or modify it under either the terms and 
##    conditions of the "The MIT License (MIT)"; or the terms and conditions 
##    of the "GPL v3 License".
################################################################################
## Configuration varibles:
##    CHILD_REPO_PATH:
##       local system path of the "child" repo
##     PARENT_REPO_URL:
##       The remote URL of the "parent" repo; the repo that is 
##       "invisibly forked".
################################################################################
CHILD_REPO_PATH=../
PARENT_REPO_URL="https://github.com/katmore/flat-webapp.git"
################################################################################
## no configuration variables beyond this point
################################################################################
################################################################################
################################################################################
################################################################################
################################################################################
################################################################################
################################################################################
################################################################################
me=`basename "$0"`
echo "$me"
echo "(c) 2012-2016 Doug Bird. All Rights Reserved."
echo "This script is part of the 'boilerplate flat web application'"
echo "See: https://github.com/katmore/flat-webapp"
cd $CHILD_REPO_ROOT
cdres=$?
if [ -d $cdres ]; then
   echo "cannot continue; change dir failed '$CHILD_REPO_ROOT'" 1>&2
   exit $cdres
fi
git remote add public $PARENT_REPO_URL
git pull public master # Creates a merge commit
pullres=$?
if [ -d $pullres ]; then
   echo "cannot continue; git pull failed '$CHILD_REPO_ROOT'" 1>&2
   exit $pullres
fi








